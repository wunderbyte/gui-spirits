const show=e=>fade(e,1),hide=e=>fade(e,0);function push(e,t){return history.pushState(null,"",e),t.stopPropagation(),t.preventDefault(),!0}function fade(e,t){return new Promise((n=>{const o=document.querySelector(e);o.addEventListener("transitionend",(function e(){o.removeEventListener("transitionend",e),n()})),o.style.opacity=t}))}function inject(e){var t;(t="#article-cover",fade(t,1)).then((()=>load(e))).then((e=>replace(e))).then((()=>snap(location.hash,!1))).then((()=>hide("#article-cover")))}function load(e){return new Promise((t=>{fetch(e).then((e=>e.text())).then((e=>(new DOMParser).parseFromString(e,"text/html"))).then(t)}))}function replace(e){document.body.className=e.body.className,document.title=e.title,swap(e,"aside ul"),swap(e,"article")}function swap(e,t){document.querySelector(t).replaceWith(e.querySelector(t))}function snap(e,t,n){if(e&&(n=document.querySelector(e))){const e={behavior:"smooth"};try{n.scrollIntoView(!t||e)}catch(e){n.scrollIntoView(!0)}}else scrollTo(0,0)}document.fonts.ready.then((()=>hide("#cover"))),document.addEventListener("click",(e=>{const{pathname:t,href:n,hash:o}=e.target;t&&(t!==location.pathname?push(n,e)&&inject(n):o!==location.hash&&push(n,e)&&snap(o,!0))})),(e=>{window.addEventListener("popstate",(t=>{const{pathname:n,href:o}=location;n!==e&&(e=n)&&inject(o)}))})(location.pathname);